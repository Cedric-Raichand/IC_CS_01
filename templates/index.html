<!DOCTYPE html>
<html lang="en">
<head>
    <title>Web Security Scanner</title>
</head>
<body>

<h1>Website Security Scanner</h1>

<form method="POST">
    <input name="url" placeholder="Enter website (example.com)" type="text">
    <button type="submit">Scan Website</button>
</form>

<hr>

{% if result %}

{% if result.error %}
<h3 style="color:red;">Error: {{ result.error }}</h3>

{% else %}

<h2>Scan Result for {{ result.url }}</h2>

<h3>Security Headers:</h3>
<ul>
    {% for header, status in result.security_headers.items() %}
    <li><strong>{{ header }}</strong> : {{ status }}</li>
    {% endfor %}
</ul>

<h3>Links Found:</h3>
<ul>
    {% for link in result.links %}
    <li>{{ link }}</li>
    {% endfor %}
</ul>

<h3>Forms Found:</h3>
<ul>
    {% for form in result.forms %}
    <li>
        Method: {{ form.method }} | Action: {{ form.action }}
        <ul>
            {% for input in form.inputs %}
            <li>{{ input.type }} : {{ input.name }}</li>
            {% endfor %}
        </ul>
    </li>
    {% endfor %}
</ul>

<h3>SQL Injection Test:</h3>
{% if result.sql_vulnerabilities %}
<ul>
    {% for vuln in result.sql_vulnerabilities %}
    <li style="color:red;">
        Vulnerable Form → Action: {{ vuln.action }} | Method: {{ vuln.method }}
        | Payload: {{ vuln.payload }}
    </li>
    {% endfor %}
</ul>
{% else %}
<p style="color:green;">No SQL Injection vulnerability detected</p>
{% endif %}

<h3>XSS Test:</h3>
{% if result.xss_vulnerabilities %}
<ul>
    {% for vuln in result.xss_vulnerabilities %}
    <li style="color:red;">
        Vulnerable Form → Action: {{ vuln.action }} | Method: {{ vuln.method }}
        | Payload: {{ vuln.payload }}
    </li>
    {% endfor %}
</ul>
{% else %}
<p style="color:green;">No XSS vulnerability detected</p>
{% endif %}

{% endif %}
{% endif %}

</body>
</html>
